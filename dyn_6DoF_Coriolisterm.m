function [C_] = dyn_6DoF_Coriolisterm(q,dq,L,m)

x1=q(1);
q2=q(2);
q3=q(3);
q4=q(4);
q5=q(5);
q6=q(6);

dx1=dq(1);
dq2=dq(2);
dq3=dq(3);
dq4=dq(4);
dq5=dq(5);
dq6=dq(6);

L1=L(1);
L2=L(2);
L3=L(3);
L4=L(4);
L5=L(5);
L6=L(6);

m1=m(1);
m2=m(2);
m3=m(3);
m4=m(4);
m5=m(5);
m6=m(6);

C1 = - (m5*(2*L2*cos(q2)*dq2^2 + 2*L4*cos(q2 + q3 + q4)*(dq2 + dq3 + dq4)^2 + 2*L3*cos(q2 + q3)*(dq2 + dq3)^2 + L5*cos(q2 + q3 + q4 + q5)*(dq2 + dq3 + dq4 + dq5)^2))/2 - (m3*(2*L2*cos(q2)*dq2^2 + L3*cos(q2 + q3)*(dq2 + dq3)^2))/2 - (m4*(2*L2*cos(q2)*dq2^2 + L4*cos(q2 + q3 + q4)*(dq2 + dq3 + dq4)^2 + 2*L3*cos(q2 + q3)*(dq2 + dq3)^2))/2 - (m6*(2*L2*cos(q2)*dq2^2 + 2*L4*cos(q2 + q3 + q4)*(dq2 + dq3 + dq4)^2 + L6*cos(q2 + q3 + q4 + q5 + q6)*(dq2 + dq3 + dq4 + dq5 + dq6)^2 + 2*L3*cos(q2 + q3)*(dq2 + dq3)^2 + 2*L5*cos(q2 + q3 + q4 + q5)*(dq2 + dq3 + dq4 + dq5)^2))/2 - (L2*m2*cos(q2)*dq2^2)/2 - (L6*m6*sin(q2 + q3 + q4 + q5 + q6)*0)/2;
C2 = - (L2*L5*m5*sin(q3 + q4 + q5)*dq3^2)/2 - (L2*L5*m5*sin(q3 + q4 + q5)*dq4^2)/2 - L2*L5*m6*sin(q3 + q4 + q5)*dq3^2 - (L2*L5*m5*sin(q3 + q4 + q5)*dq5^2)/2 - L2*L5*m6*sin(q3 + q4 + q5)*dq4^2 - L2*L5*m6*sin(q3 + q4 + q5)*dq5^2 - (L3*L6*m6*sin(q4 + q5 + q6)*dq4^2)/2 - (L3*L6*m6*sin(q4 + q5 + q6)*dq5^2)/2 - (L3*L6*m6*sin(q4 + q5 + q6)*dq6^2)/2 - (L2*L4*m4*sin(q3 + q4)*dq3^2)/2 - (L2*L4*m4*sin(q3 + q4)*dq4^2)/2 - L2*L4*m5*sin(q3 + q4)*dq3^2 - L2*L4*m5*sin(q3 + q4)*dq4^2 - L2*L4*m6*sin(q3 + q4)*dq3^2 - L2*L4*m6*sin(q3 + q4)*dq4^2 - (L3*L5*m5*sin(q4 + q5)*dq4^2)/2 - (L3*L5*m5*sin(q4 + q5)*dq5^2)/2 - L3*L5*m6*sin(q4 + q5)*dq4^2 - L3*L5*m6*sin(q4 + q5)*dq5^2 - (L4*L6*m6*sin(q5 + q6)*dq5^2)/2 - (L4*L6*m6*sin(q5 + q6)*dq6^2)/2 - (L2*L3*m3*sin(q3)*dq3^2)/2 - L2*L3*m4*sin(q3)*dq3^2 - L2*L3*m5*sin(q3)*dq3^2 - L2*L3*m6*sin(q3)*dq3^2 - (L3*L4*m4*sin(q4)*dq4^2)/2 - L3*L4*m5*sin(q4)*dq4^2 - L3*L4*m6*sin(q4)*dq4^2 - (L4*L5*m5*sin(q5)*dq5^2)/2 - L4*L5*m6*sin(q5)*dq5^2 - (L5*L6*m6*sin(q6)*dq6^2)/2 - (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq3^2)/2 - (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq4^2)/2 - (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq5^2)/2 - (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq6^2)/2 - L2*L3*m3*sin(q3)*dq2*dq3 - 2*L2*L3*m4*sin(q3)*dq2*dq3 - 2*L2*L3*m5*sin(q3)*dq2*dq3 - 2*L2*L3*m6*sin(q3)*dq2*dq3 - L3*L4*m4*sin(q4)*dq2*dq4 - L3*L4*m4*sin(q4)*dq3*dq4 - 2*L3*L4*m5*sin(q4)*dq2*dq4 - 2*L3*L4*m5*sin(q4)*dq3*dq4 - 2*L3*L4*m6*sin(q4)*dq2*dq4 - 2*L3*L4*m6*sin(q4)*dq3*dq4 - L4*L5*m5*sin(q5)*dq2*dq5 - L4*L5*m5*sin(q5)*dq3*dq5 - 2*L4*L5*m6*sin(q5)*dq2*dq5 - L4*L5*m5*sin(q5)*dq4*dq5 - 2*L4*L5*m6*sin(q5)*dq3*dq5 - 2*L4*L5*m6*sin(q5)*dq4*dq5 - L5*L6*m6*sin(q6)*dq2*dq6 - L5*L6*m6*sin(q6)*dq3*dq6 - L5*L6*m6*sin(q6)*dq4*dq6 - L5*L6*m6*sin(q6)*dq5*dq6 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2*dq3 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2*dq4 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2*dq5 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq3*dq4 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2*dq6 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq3*dq5 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq3*dq6 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq4*dq5 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq4*dq6 - L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq5*dq6 - L2*L5*m5*sin(q3 + q4 + q5)*dq2*dq3 - L2*L5*m5*sin(q3 + q4 + q5)*dq2*dq4 - 2*L2*L5*m6*sin(q3 + q4 + q5)*dq2*dq3 - L2*L5*m5*sin(q3 + q4 + q5)*dq2*dq5 - L2*L5*m5*sin(q3 + q4 + q5)*dq3*dq4 - 2*L2*L5*m6*sin(q3 + q4 + q5)*dq2*dq4 - L2*L5*m5*sin(q3 + q4 + q5)*dq3*dq5 - 2*L2*L5*m6*sin(q3 + q4 + q5)*dq2*dq5 - 2*L2*L5*m6*sin(q3 + q4 + q5)*dq3*dq4 - L2*L5*m5*sin(q3 + q4 + q5)*dq4*dq5 - 2*L2*L5*m6*sin(q3 + q4 + q5)*dq3*dq5 - 2*L2*L5*m6*sin(q3 + q4 + q5)*dq4*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq4 - L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq3*dq4 - L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq3*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq3*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq4*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq4*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq5*dq6 - L2*L4*m4*sin(q3 + q4)*dq2*dq3 - L2*L4*m4*sin(q3 + q4)*dq2*dq4 - 2*L2*L4*m5*sin(q3 + q4)*dq2*dq3 - L2*L4*m4*sin(q3 + q4)*dq3*dq4 - 2*L2*L4*m5*sin(q3 + q4)*dq2*dq4 - 2*L2*L4*m6*sin(q3 + q4)*dq2*dq3 - 2*L2*L4*m5*sin(q3 + q4)*dq3*dq4 - 2*L2*L4*m6*sin(q3 + q4)*dq2*dq4 - 2*L2*L4*m6*sin(q3 + q4)*dq3*dq4 - L3*L5*m5*sin(q4 + q5)*dq2*dq4 - L3*L5*m5*sin(q4 + q5)*dq2*dq5 - L3*L5*m5*sin(q4 + q5)*dq3*dq4 - 2*L3*L5*m6*sin(q4 + q5)*dq2*dq4 - L3*L5*m5*sin(q4 + q5)*dq3*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq2*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq3*dq4 - L3*L5*m5*sin(q4 + q5)*dq4*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq3*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq4*dq5 - L4*L6*m6*sin(q5 + q6)*dq2*dq5 - L4*L6*m6*sin(q5 + q6)*dq2*dq6 - L4*L6*m6*sin(q5 + q6)*dq3*dq5 - L4*L6*m6*sin(q5 + q6)*dq3*dq6 - L4*L6*m6*sin(q5 + q6)*dq4*dq5 - L4*L6*m6*sin(q5 + q6)*dq4*dq6 - L4*L6*m6*sin(q5 + q6)*dq5*dq6;
C3 = (L2*L5*m5*sin(q3 + q4 + q5)*dq2^2)/2 + L2*L5*m6*sin(q3 + q4 + q5)*dq2^2 - (L3*L6*m6*sin(q4 + q5 + q6)*dq4^2)/2 - (L3*L6*m6*sin(q4 + q5 + q6)*dq5^2)/2 - (L3*L6*m6*sin(q4 + q5 + q6)*dq6^2)/2 + (L2*L4*m4*sin(q3 + q4)*dq2^2)/2 + L2*L4*m5*sin(q3 + q4)*dq2^2 + L2*L4*m6*sin(q3 + q4)*dq2^2 - (L3*L5*m5*sin(q4 + q5)*dq4^2)/2 - (L3*L5*m5*sin(q4 + q5)*dq5^2)/2 - L3*L5*m6*sin(q4 + q5)*dq4^2 - L3*L5*m6*sin(q4 + q5)*dq5^2 - (L4*L6*m6*sin(q5 + q6)*dq5^2)/2 - (L4*L6*m6*sin(q5 + q6)*dq6^2)/2 + (L2*L3*m3*sin(q3)*dq2^2)/2 + L2*L3*m4*sin(q3)*dq2^2 + L2*L3*m5*sin(q3)*dq2^2 + L2*L3*m6*sin(q3)*dq2^2 - (L3*L4*m4*sin(q4)*dq4^2)/2 - L3*L4*m5*sin(q4)*dq4^2 - L3*L4*m6*sin(q4)*dq4^2 - (L4*L5*m5*sin(q5)*dq5^2)/2 - L4*L5*m6*sin(q5)*dq5^2 - (L5*L6*m6*sin(q6)*dq6^2)/2 + (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2^2)/2 - L3*L4*m4*sin(q4)*dq2*dq4 - L3*L4*m4*sin(q4)*dq3*dq4 - 2*L3*L4*m5*sin(q4)*dq2*dq4 - 2*L3*L4*m5*sin(q4)*dq3*dq4 - 2*L3*L4*m6*sin(q4)*dq2*dq4 - 2*L3*L4*m6*sin(q4)*dq3*dq4 - L4*L5*m5*sin(q5)*dq2*dq5 - L4*L5*m5*sin(q5)*dq3*dq5 - 2*L4*L5*m6*sin(q5)*dq2*dq5 - L4*L5*m5*sin(q5)*dq4*dq5 - 2*L4*L5*m6*sin(q5)*dq3*dq5 - 2*L4*L5*m6*sin(q5)*dq4*dq5 - L5*L6*m6*sin(q6)*dq2*dq6 - L5*L6*m6*sin(q6)*dq3*dq6 - L5*L6*m6*sin(q6)*dq4*dq6 - L5*L6*m6*sin(q6)*dq5*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq4 - L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq3*dq4 - L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq3*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq3*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq4*dq5 - L3*L6*m6*sin(q4 + q5 + q6)*dq4*dq6 - L3*L6*m6*sin(q4 + q5 + q6)*dq5*dq6 - L3*L5*m5*sin(q4 + q5)*dq2*dq4 - L3*L5*m5*sin(q4 + q5)*dq2*dq5 - L3*L5*m5*sin(q4 + q5)*dq3*dq4 - 2*L3*L5*m6*sin(q4 + q5)*dq2*dq4 - L3*L5*m5*sin(q4 + q5)*dq3*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq2*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq3*dq4 - L3*L5*m5*sin(q4 + q5)*dq4*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq3*dq5 - 2*L3*L5*m6*sin(q4 + q5)*dq4*dq5 - L4*L6*m6*sin(q5 + q6)*dq2*dq5 - L4*L6*m6*sin(q5 + q6)*dq2*dq6 - L4*L6*m6*sin(q5 + q6)*dq3*dq5 - L4*L6*m6*sin(q5 + q6)*dq3*dq6 - L4*L6*m6*sin(q5 + q6)*dq4*dq5 - L4*L6*m6*sin(q5 + q6)*dq4*dq6 - L4*L6*m6*sin(q5 + q6)*dq5*dq6;
C4 = (L2*L5*m5*sin(q3 + q4 + q5)*dq2^2)/2 + L2*L5*m6*sin(q3 + q4 + q5)*dq2^2 + (L3*L6*m6*sin(q4 + q5 + q6)*dq2^2)/2 + (L3*L6*m6*sin(q4 + q5 + q6)*dq3^2)/2 + (L2*L4*m4*sin(q3 + q4)*dq2^2)/2 + L2*L4*m5*sin(q3 + q4)*dq2^2 + L2*L4*m6*sin(q3 + q4)*dq2^2 + (L3*L5*m5*sin(q4 + q5)*dq2^2)/2 + (L3*L5*m5*sin(q4 + q5)*dq3^2)/2 + L3*L5*m6*sin(q4 + q5)*dq2^2 + L3*L5*m6*sin(q4 + q5)*dq3^2 - (L4*L6*m6*sin(q5 + q6)*dq5^2)/2 - (L4*L6*m6*sin(q5 + q6)*dq6^2)/2 + (L3*L4*m4*sin(q4)*dq2^2)/2 + (L3*L4*m4*sin(q4)*dq3^2)/2 + L3*L4*m5*sin(q4)*dq2^2 + L3*L4*m5*sin(q4)*dq3^2 + L3*L4*m6*sin(q4)*dq2^2 + L3*L4*m6*sin(q4)*dq3^2 - (L4*L5*m5*sin(q5)*dq5^2)/2 - L4*L5*m6*sin(q5)*dq5^2 - (L5*L6*m6*sin(q6)*dq6^2)/2 + (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2^2)/2 + L3*L4*m4*sin(q4)*dq2*dq3 + 2*L3*L4*m5*sin(q4)*dq2*dq3 + 2*L3*L4*m6*sin(q4)*dq2*dq3 - L4*L5*m5*sin(q5)*dq2*dq5 - L4*L5*m5*sin(q5)*dq3*dq5 - 2*L4*L5*m6*sin(q5)*dq2*dq5 - L4*L5*m5*sin(q5)*dq4*dq5 - 2*L4*L5*m6*sin(q5)*dq3*dq5 - 2*L4*L5*m6*sin(q5)*dq4*dq5 - L5*L6*m6*sin(q6)*dq2*dq6 - L5*L6*m6*sin(q6)*dq3*dq6 - L5*L6*m6*sin(q6)*dq4*dq6 - L5*L6*m6*sin(q6)*dq5*dq6 + L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq3 + L3*L5*m5*sin(q4 + q5)*dq2*dq3 + 2*L3*L5*m6*sin(q4 + q5)*dq2*dq3 - L4*L6*m6*sin(q5 + q6)*dq2*dq5 - L4*L6*m6*sin(q5 + q6)*dq2*dq6 - L4*L6*m6*sin(q5 + q6)*dq3*dq5 - L4*L6*m6*sin(q5 + q6)*dq3*dq6 - L4*L6*m6*sin(q5 + q6)*dq4*dq5 - L4*L6*m6*sin(q5 + q6)*dq4*dq6 - L4*L6*m6*sin(q5 + q6)*dq5*dq6;
C5 = (L2*L5*m5*sin(q3 + q4 + q5)*dq2^2)/2 + L2*L5*m6*sin(q3 + q4 + q5)*dq2^2 + (L3*L6*m6*sin(q4 + q5 + q6)*dq2^2)/2 + (L3*L6*m6*sin(q4 + q5 + q6)*dq3^2)/2 + (L3*L5*m5*sin(q4 + q5)*dq2^2)/2 + (L3*L5*m5*sin(q4 + q5)*dq3^2)/2 + L3*L5*m6*sin(q4 + q5)*dq2^2 + L3*L5*m6*sin(q4 + q5)*dq3^2 + (L4*L6*m6*sin(q5 + q6)*dq2^2)/2 + (L4*L6*m6*sin(q5 + q6)*dq3^2)/2 + (L4*L6*m6*sin(q5 + q6)*dq4^2)/2 + (L4*L5*m5*sin(q5)*dq2^2)/2 + (L4*L5*m5*sin(q5)*dq3^2)/2 + L4*L5*m6*sin(q5)*dq2^2 + (L4*L5*m5*sin(q5)*dq4^2)/2 + L4*L5*m6*sin(q5)*dq3^2 + L4*L5*m6*sin(q5)*dq4^2 - (L5*L6*m6*sin(q6)*dq6^2)/2 + (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2^2)/2 + L4*L5*m5*sin(q5)*dq2*dq3 + L4*L5*m5*sin(q5)*dq2*dq4 + 2*L4*L5*m6*sin(q5)*dq2*dq3 + L4*L5*m5*sin(q5)*dq3*dq4 + 2*L4*L5*m6*sin(q5)*dq2*dq4 + 2*L4*L5*m6*sin(q5)*dq3*dq4 - L5*L6*m6*sin(q6)*dq2*dq6 - L5*L6*m6*sin(q6)*dq3*dq6 - L5*L6*m6*sin(q6)*dq4*dq6 - L5*L6*m6*sin(q6)*dq5*dq6 + L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq3 + L3*L5*m5*sin(q4 + q5)*dq2*dq3 + 2*L3*L5*m6*sin(q4 + q5)*dq2*dq3 + L4*L6*m6*sin(q5 + q6)*dq2*dq3 + L4*L6*m6*sin(q5 + q6)*dq2*dq4 + L4*L6*m6*sin(q5 + q6)*dq3*dq4;
C6 = (L3*L6*m6*sin(q4 + q5 + q6)*dq2^2)/2 + (L3*L6*m6*sin(q4 + q5 + q6)*dq3^2)/2 + (L4*L6*m6*sin(q5 + q6)*dq2^2)/2 + (L4*L6*m6*sin(q5 + q6)*dq3^2)/2 + (L4*L6*m6*sin(q5 + q6)*dq4^2)/2 + (L5*L6*m6*sin(q6)*dq2^2)/2 + (L5*L6*m6*sin(q6)*dq3^2)/2 + (L5*L6*m6*sin(q6)*dq4^2)/2 + (L5*L6*m6*sin(q6)*dq5^2)/2 + (L2*L6*m6*sin(q3 + q4 + q5 + q6)*dq2^2)/2 + L5*L6*m6*sin(q6)*dq2*dq3 + L5*L6*m6*sin(q6)*dq2*dq4 + L5*L6*m6*sin(q6)*dq2*dq5 + L5*L6*m6*sin(q6)*dq3*dq4 + L5*L6*m6*sin(q6)*dq3*dq5 + L5*L6*m6*sin(q6)*dq4*dq5 + L3*L6*m6*sin(q4 + q5 + q6)*dq2*dq3 + L4*L6*m6*sin(q5 + q6)*dq2*dq3 + L4*L6*m6*sin(q5 + q6)*dq2*dq4 + L4*L6*m6*sin(q5 + q6)*dq3*dq4;


C_ =[C1;
    C2;
    C3;
    C4;
    C5;
    C6];



end